% !TEX root = ../thesis.tex

\chapter{Summary} \label{summary}
The aim of this master's thesis was to improve the~accuracy of linear prediction models for sales
and financial forecasting using modern machine learning techniques. To achieve this goal, a~mathematical
model based on long-term linear prediction was created, and periodical weights were implemented
to improve the~accuracy of the~linear prediction models.\\
\\
Two main techniques were employed to apply machine learning to linear prediction. The~first technique,
called feature engineering, involved using machine learning to extract meaningful features from
the input signal, which were then used as inputs for a~linear prediction model. Several feature
engineering techniques were used, including principal component analysis, wavelet transform, and
Fourier transform.\\
\\
The second technique involved model selection and training, which used machine learning to choose
the best linear model for the~prediction task and estimate its parameters from the~data. Common machine
learning algorithms such as linear regression, support vector regression, and artificial neural networks
were used for model selection and training.\\
\\
The ultimate goal of long-term linear prediction was to estimate future values of a~signal or time
series based on its past values using a~linear model. The~extended long-term linear prediction method
proved to be the~most effective, with comparison parameters such as R2 getting 0.9171, RMSE of 34.7782, and MSE ending
with a~value of 1206.7.\\
\\
The dataset used for the~analysis was collected in 2022 as real orders. The~first part of the~dataset
was used to train the~models, and the~second part was used to validate the~results.\\
\\
The results of this study were achieved in collaboration with the~E-commerce Association o.z,
the creator of the~storePredictor platform. The~organization provided valuable business insights into
the industry, which helped set mechanisms for periodical weights to extend linear prediction models
with minimal deflection. As a~result, the~next steps should focus on clearly defining and validating
mechanisms to set independent industry weights only on ordinary accessible data without consultation
with business owners.\\
\\
In conclusion, this study successfully improved the~accuracy of linear prediction models for sales
and financial forecasting by utilizing modern machine learning techniques. The~results of this study
have practical implications for businesses, as accurate forecasting can help them make better decisions,
increase profits, and achieve their goals.

\chapter{Resume} \label{resume}
    \section{Analýza} \label{sk:analytic}
    Lineárna predikcia je štatistická metóda používaná na predpovedanie budúcich hodnôt na základe historických dát pre
    identifikaciu parametrov pouziva Durbin-Levinsonov algoritmus což je metóda riešenia sustav rovníc pre
    autoregresívne (AR) modely, ktoré sú modely, kde aktuálny výstup závisí od predchádzajúcich výstupov. Algoritmus
    rieši problém lineárnej predikcie nájdením koeficientov AR modelu, ktoré minimalizujú chybu predikcie. Výsledné AR
    koeficienty môžu byť použité na predpovedanie budúcich hodnôt na základe minulých pozorovaní. Táto metóda by sa mala
    používať s použitím vzoru lineárneho vzťahu medzi nezávislými a~závislými premennými. Tu je základný prehľad krokov
    pri použití lineárnej predikcie na predpovedanie dát o predaji:\\
    \begin{enumerate}
        \item Zbierajte dáta o predaji\\
        Získajte historické dáta o predaji produktu alebo služby, ktorú chcete predpovedať.
        \item Vykreslite dáta\\
        Vykreslite dáta o predaji v čase, aby ste vizuálne preskúmali trend\\a~identifikovali akékoľvek vzory.
        \item Vyberte model\\
        Vyberte vhodný lineárny model na zobrazenie vzťahu medzi nezávislými a~závislými
        premennými v dátach. Napríklad by ste si mohli vybrať jednoduchý lineárny regresný model.
        \item Natrénujte model\\
        Natrénujte vybraný model na historických dátach o predaji napriklad pomocou metódy najmenšie štvorcov.
    \end{enumerate}
    Autoregresívne (AR) modely sú modely časových radov, ktoré popisujú vzťah medzi súčasnou hodnotou premennej a~jej
    minulými hodnotami.\\V autoregresívnom modeli je každé pozorovanie modelované ako lineárna kombinácia minulých
    pozorovaní, s váhami nazývanými AR koeficienty. AR modely sú široko používané v rôznych oblastiach, ako je ekonomika,
    inžinierstvo a~financie na modelovanie a~predpovedanie časových radovov. Rád AR modelu, označované
    ako "p", sa vzťahuje na počet minulých hodnôt použitých na predpovedanie súčasnej hodnoty. Napríklad AR(1) model
    používa len predchádzajúce pozorovanie na predpovedanie súčasnej hodnoty, zatiaľ čo AR(2) model používa predchádzajúce
    dve pozorovania.\\
    \\
    \textbf{Predpovedanie budúcich predajov}\\
    Použijeme trénovaný model na predpovedanie budúcich predajov. Môžete chcieť generovať predpovede na niekoľko
    mesiacov alebo rokov dopredu. Postupujte nasledovne:
    \begin{enumerate}
        \item Zhodnoťte model\\
        Zhodnoťte presnosť predpovedí porovnaním s faktickými predajovými dátami. Na kvantifikáciu výkonu modelu
        použite metriky ako priemerná absolútna chyba alebo koreňová stredná štvorcová chyba.
        \item Vylepšite model\\
        Ak je to potrebné, pridajte ďalšie nezávislé premenné alebo transformujte existujúce premenné, aby ste vylepšili
        model.
        \item Opakujte kroky trénovania a hodnotenia, kým nebudete mať model, ktorý poskytuje presné prognózy.
        \item Pre výpočet posunu v dlhodobom predpovedaní môžete použiť autokorelačnú metódu. V tejto práci sa vyvinie
        neurónová sieť na identifikáciu posunu a podobný mechanizmus pre optimálne určenie poradia.
    \end{enumerate}
    Použite trénovaný model na predpovedanie budúcich predajových dát. Môžete chcieť generovať
    predpovede na niekoľko mesiacov alebo rokov dopredu.\\
    \\
    \textbf{Modely používané pre predikcie ekonomických dát} \\
    Existuje niekoľko matematických modelov používaných pre predpovedanie predaja, vrátane:\\
    \begin{enumerate}
        \item Modely časových radov
        \\Tieto modely sa používajú na analýzu a~predpovedanie ekonomických dát v čase,
        ako sú sezónne výkyvy, trendy a~fluktuácie. Príklady zahŕňajú ARIMA (AutoRegressive Integrated Moving Average),
        SARIMA (Seasonal ARIMA) a~exponenciálne vyhladzovanie.
        \item Regresné modely\\
        Tieto modely používajú historické údaje na určenie vzťahu medzi predajom a~jednou alebo
        viacerými nezávislými premennými, ako sú cena, propagácia a~reklama. Príklady zahŕňajú lineárnu regresiu,
        logistickú regresiu a~viacnásobnú regresiu.
        \item Modely stromových rozhodnutí\\
        Tieto modely používajú štruktúru stromu na rozhodovanie založené na vzťahu medzi
        predajom a~viacerými nezávislými premennými. Príklady zahŕňajú CART (Klasifikácia a~regresia rozhodovacích
        stromov) a~náhodných stromov.
        \item Modely strojového učenia\\
        Tieto modely používajú algoritmy ako neurónové siete a~stroje s podpornými vektormi na predikovanie
        na základe vzorov v údajoch.
    \end{enumerate}
    \textbf{Neurónove sieťe} \\
    Neurónová sieť je druh algoritmu strojového učenia inšpirovaný štruktúrou\\a~funkciou biologických neurónov v
    ľudskom mozgu. Skladá sa z prepojených uzlov, nazývaných neuróny, ktoré sú usporiadané do vrstiev. Vstupná vrstva
    prijíma surové dáta, ako sú obrázky alebo text, a~prenáša ich do skrytých vrstiev, ktoré vykonávajú výpočty a~váhy
    sa aplikujú na vstupné dáta pre vytvorenie predikcie. Nakoniec výstupná vrstva produkuje konečnú predikciu
    alebo klasifikáciu.\\
    \\
    Ako môžete vidieť na obrázku\ref{fig:perceptron}, každý vstup $X_n$ by mal byť správne ohodnotený určitou
    váhou $W_n$ predtým, než všetky signály vstúpia do sumovacej fázy. Potom sa vážené súčty prenášajú do aktivačnej
    jednotky produkujúcej výstupný signál neurónu.\\
    \\
    Neurónové siete sa trénujú na veľkých dátových súboroch pomocou procesu nazývaného spätné šírenie chyby, ktorý
    upravuje váhy a~sklon neurónov, aby minimalizoval rozdiel medzi predpovedaným výstupom a~skutočným výstupom.
    Akonáhle je neurónová sieť natrénovaná, môže sa použiť na predpovedanie nových dát.\\
    \\
    Neurón je základnou stavebnou jednotkou neurónovej siete, známy aj ako umelý neurón alebo perceptrón.
    Modeluje sa podľa biologického neurónu v ľudskom mozgu, ktorý prijíma vstupné signály z iných neurónov,
    spracováva ich a~posiela výstupné signály do ďalších neurónov.\\
    \\
    V neurónovej sieti neurón prijíma vstup od iných neurónov alebo priamo od vstupných dát, aplikuje na vstup
    matematickú funkciu a~produkuje výstup, ktorý sa posiela do ďalších neurónov v sieti. Vstupom do neurónu je
    zvyčajne vektor čísel a~každý vstup sa násobí príslušnou váhou.\\
    \\
    Potom neuron sčíta vážené vstupy, pridáva sklon a~aplikuje aktivačnú funkciu na výsledok. Úlohou aktivačnej
    funkcie je zaviesť nelinearitu do neurónu, čo umožňuje neuronovej sieti naučiť sa zložité vzorce a~vzťahy v dátach.
    Existuje niekoľko rôznych typov aktivačných funkcií, ktoré sa môžu použiť, ako napríklad sigmoidná funkcia,
    ReLU (Rectified Linear Unit) funkcia a~tanh (hyperbolická tangens) funkcia.\\
    \\
    Výstup neurónu sa zvyčajne posúva do ďalších neurónov v nasledujúcej vrstve neurónovej siete. Váhy a~sklon
    neurónov sa počas trénovania prispôsobujú technikou spätného šírenia chyby, ktorá zahŕňa výpočet gradientu chyby
    vzhľadom na váhy a~aktualizovanie ich pomocou optimalizačného algoritmu, ako je stochastický gradientový zostup.\\
    \\
    Celkovo neuróny v neurónovej sieti spolupracujú na učení vzorcov a~vzťahov vstupných dát a~produkujú výstup,
    ktorý sa môže použiť pre rôzne úlohy, ako je klasifikácia, regresia a~predikcia.\\
    \\
    Neurónové siete sa úspešne uplatňujú v širokej škále oblastí, vrátane rozpoznávania obrazov a~reči, spracovania
    prirodzeného jazyka a~autonómnych vozidiel, medzi inými.

    \section{Syntéza}
    Vychádzajme z kapitoly \ref{sk:analytic} a na ich základe vytvoríme nové matematické modely a~prístupy, aby sme mohli
    vykonať rýchle a~presné predpovede predaja,ktoré sa skladajú z long-term lineárnej predikcie s individuálnymi
    váhami vypočítanými pre každé obdobie, založené na Levinson-Durbinovej schéme, nový mode nazývane Extended Linear
    Prediction (ELP). Očakávame lepšie výsledky než pri použití predikcie založenej na krátkodobej alebo štandardnej
    long-term lineárnej predikcii (viď časť \ref{sec:lp}). Nakoniec, náš prístup bude predikovat budúce hodnoty predaja
    na základe predchádzajúcich dát s lepšou odchýlkou, než to dokáže lineárna predikcia.\\
    \\
    Pre vytvorenie matematického modelu na predikciu predajných dát s periodickými trendmi môžeme použiť model
    sezónnej ARIMA (SARIMA). Tento model zohľadňuje sezónne variácie v dátach a~používa autoregresívne a~kĺzavé
    priemerové členy na zachytenie vzorov a~trendov v dátach.\\
    \\
    Pre náš účel sme vytvorili rozšírenú dlhodobú predikciu, ktorá sa vysporiada so sezónnymi a~opakujúcimi sa vzormi
    v ekonomických dátach. Tento korekčný mechanizmus sa používa na zohľadnenie historických vrcholov v grafoch
    napriec datasetom. Táto jednoduchá korekcia zvyšuje presnosť modelu a~získava lepšiu odpoveď
    vďaka psychologickým, sociologickým a~marketingovým aspektom v datasete.\\
    \\
    Na nastavenie periodických váh je potrebné vytvoriť vektor korekčných parametrov z pôvodného datasetu pomocou
    štatistických parametrov mediánu a~štandardnej odchýlky z datasetu. Ako základnú rovnicu použijeme rovnicu pre
    dlhodobú predikciu \ref{sec:extlonglp} s novými váhami a~získame tak lepšie výsledky.

    \section{Experiment}
    Pripravme experiment na overenie dlhodobého lineárneho predikčného modelu objednávok internetového obchodu.
    Zostavíme experiment podľa týchto krokov:
    \begin{enumerate}
        \item Definujeme problém a~ciele\\
        Jasne definujte problém a~predmet ktoré má vyriešiť dlhodobý lineárny\\ predikčný model.
        V našem pripadu je to predpovedať objednávky v internetovom obchode na dlhé časové obdobie
        pomocou lineárneho modelu.
        \item  Zhromažďovanie údajov\\
        Zhromažďujeme historické údaje o objednávkach online obchodov, ako je napríklad
        objednávka dátumy, sumy objednávok a~ďalšie relevantné premenné. Tieto údaje budú použité trénovať a~overovať
        model long-term lineárnej predikcie. Naše údaje boli zbierať z online systému storePredictor,
        ktorý je dostupný na storepredictor.com a~údaje sú anonymizované a~pseudonimizované, aby sa mohli použiť
        na ďalšie potrebné výpočty.
        \item  Pripravíme údaje\\
        Vyčistime a~predspracujeme údaje, aby sme sa uistili, že sú konzistentné a~vhodné na
        použitie v dlhodobom lineárnom predikčnom modeli. Toto môže zahŕňat postupy ako je odstraňovanie duplikátov,
        spracovanie chýbajúcich hodnôt a~transformovanie premenné podľa potreby. Predspracovanie našich údajov
        je popísané v \ref{subsec:preprocessing}.
        \item  Vytvoríme model long-term lineárnej predikcie\\
        Pomocou historických údajov, vyvinieme dlhodobý lineárny predikčný model, ktorý dokáže predpovedať
        internetový obchod objednávky počas určitého časového obdobia, ktoré je podrobne popísané v bode \ref{subsec:combining_models} a~prakticky
        aplikovaný v \ref{evaluation}
        \item  Overenie modelu\\
        Keď je model vytvorený, je potrebné ho overiť, aby sme zabezpečili, že je presný a~účinný.
        \item Vyhodnotíme výsledky\\
        Analyzujeme výsledky experimentu, aby sme určili presnosť modelu long-term lineárnej
        predikcie. To bude zahŕňať výpočet metrík, ako je stredná kvadratická chyba (MSE), r-square (R2) a~relativná stredná
        kvadratická chyba (RMSE) \ref{subsec:experimentResults}
        \item Počas riešenia predchádzajúcich krokov bol model predefinovaný a~revalidovaný, keď výsledky neboli uspokojivé,
        upravili sme model a~zopakovali validáciu až kým nevzniknul presný a~efektívny dlhodobý lineárny predikčný model.
    \end{enumerate}
    Stručne povedané, museli sme pripraviť experiment na overenie long-term lineárnej predpovede model pre objednávky v
    internetovom obchode, kde sme museli definovať problém a~ciele, zhromažďovať a~pripravovať údaje, vyvíjať model,
    overovať ho, hodnotiť výsledky, a~ak je to potrebné, model spresnit a~znovu overovat.

    \section{Záver}
    Cieľom tejto diplomovej práce bolo zlepšiť presnosť lineárnej predikcie
    a vytvorit vlasné modely pre predaj a~finančné prognózy využívajúce moderné technológie
    strojového učenia. Na dosiahnutie tohto cieľa sme vytvorili matematický model založený na dlhodobom lineárnom
    predikčnom modeli a~boli implementované periodické váhy na zlepšenie presnosť lineárnych predikčných modelov.\\
    \\
    Na aplikáciu strojového učenia na lineárne predikcie sme pouzili dve metódy. Prvá technika,
    nazývaná inžinierstvo funkcií, zahŕňala použitie strojového učenia na extrahovanie zmysluplné
    vlastnosti zo vstupného signálu, ktoré boli vtedy používané ako vstupy pre lineárny predikčný
    model. Boli použité niques, vrátane analýzy hlavných komponentov, vlnkovej transformácie,
    a~Fourierova transformácia.\\
    \\
    Druhá technika zahŕňala výber modelu a~tréning, ktorý využíval schopnosť
    naučiť sa vybrať najlepší lineárny model pre predikčnú úlohu a~odhadnúť jeho
    parametre z údajov. Bežné algoritmy strojového učenia, ako napríklad lineárna regresia,
    podporná vektorová regresia a~umelé neurónové siete pre výber modelu a~tréning.\\
    \\
    Konečným cieľom dlhodobej lineárnej predikcie bolo odhadnúť budúce hodnoty
    objdnávok alebo časového radu ekonomíckých dát na základe minulých hodnôt pomocou
    lineárneho modelu. Rozšírená dlhodová predikcia z nášho experimentu sa ukázala ako
    najefektívnejšia a porovnávacie parametre $R^2$ 0,9171, RMSE 34,7782 a~MSE 1206,7 byla zo všetkých
    testovacích modelov najlepší.\\
    \\
    Súbor údajov použitý na analýzu sme zozbierali v roku 2022 ako skutočné objednávky. Prvu
    časť súboru údajov bola použitá na trénovanie modelov a~druhá časť bola použitá na
    overení výsledkov.\\
    \\
    Výsledky tejto štúdie boli dosiahnuté vo spolupráci s E-commerce
    Association o.z, tvorca platformy storePredictor. Organizácia poskytla cenné obchodné
    poznatky v tomto odvetví, ktoré pomohli nastaviť mechanizmy
    pre periodické váhy na rozšírenie modelov lineárnej predikcie s minimálnou odchzlkou.
    V dôsledku toho by sa ďalšie kroky mali zamerať na jasné definovanie a~overenie
    mechanizmov na nastavenie nezávislých odvetvových váh len na bežne dostupné údaje
    bez konzultácie s majiteľmi firiem.\\
    \\
    Na záver, táto štúdia úspešne zlepšila presnosť lineárnej predikcie pre predaj a~finančné
    prognózy s využitím moderného strojového učenia. Výsledky tejto štúdie majú praktické
    dôsledky pre podniky, keďže presné predpovede im môžu pomôcť robiť lepšie rozhodnutia,
    zvýšiť zisky a dosiahnuť svoje ciele.
